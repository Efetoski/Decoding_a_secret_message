import requests
from bs4 import BeautifulSoup


def decode_hidden_msg(doc_url: str):
    """
    Load and extract from the published Google Doc containing characters with x, y coordinates,
    build a 2D grid, and prints the hidden message.
    """
    # get the document
    get_response = requests.get(doc_url)
    get_response.raise_for_status()

    b_soup = BeautifulSoup(get_response.text, "html.parser")

    # Extract table rows
    rows = b_soup.find_all('tr')

    cord_points = []
    maximum_x = 0
    maximum_y = 0

    # Parse each row
    for row in rows:
        cols = row.find_all('td')
        if len(cols) < 3:
            continue
        try:
            x = int(cols[0].get_text(strip=True))
            char = cols[1].get_text(strip=True)
            y = int(cols[2].get_text(strip=True))
        except ValueError:
            continue  # avoid invalid rows and  header

        cord_points.append((x, y, char))
        maximum_x = max(maximum_x, x)
        maximum_y = max(maximum_y, y)

    # Initiate the grid with spaces
    grid = []
    for _ in range(maximum_y + 1):
        grid.append([' '] * (maximum_x + 1))

    # Position the characters
    for x, y, char in cord_points:
        grid[y][x] = char

    # Print the grid row by row
    for row in grid:
        print(''.join(row))

# Call function
decode_hidden_msg(
    "https://docs.google.com/document/d/e/2PACX-1vRPzbNQcx5UriHSbZ-9vmsTow_R6RRe7eyAU60xIF9Dlz-vaHiHNO2TKgDi7jy4ZpTpNqM7EvEcfr_p/pub"
)
